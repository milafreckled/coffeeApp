{"ast":null,"code":"import { Coffee } from '../logic/Coffee';\nimport { TastingRating } from '../logic/TastingRating';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../geo-location.service\";\nimport * as i3 from \"../data.service\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/material/button\";\nimport * as i7 from \"@angular/material/input\";\nimport * as i8 from \"@angular/material/form-field\";\nimport * as i9 from \"@angular/material/select\";\nimport * as i10 from \"@angular/material/core\";\nimport * as i11 from \"@angular/material/slider\";\nimport * as i12 from \"@angular/material/slide-toggle\";\nimport * as i13 from \"@angular/material/card\";\nfunction CoffeeComponent_mat_error_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"Coffee name is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CoffeeComponent_mat_error_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"Coffee name is invalid\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CoffeeComponent_mat_form_field_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"mat-form-field\")(1, \"input\", 14);\n    i0.ɵɵlistener(\"ngModelChange\", function CoffeeComponent_mat_form_field_10_Template_input_ngModelChange_1_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.coffee.location.address = $event);\n    });\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", ctx_r2.coffee.location.address);\n  }\n}\nfunction CoffeeComponent_mat_form_field_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"mat-form-field\")(1, \"input\", 15);\n    i0.ɵɵlistener(\"ngModelChange\", function CoffeeComponent_mat_form_field_11_Template_input_ngModelChange_1_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.coffee.location.city = $event);\n    });\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", ctx_r3.coffee.location.city);\n  }\n}\nfunction CoffeeComponent_section_20_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"section\", 16)(1, \"label\");\n    i0.ɵɵtext(2, \"Aroma\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"mat-slider\", 17);\n    i0.ɵɵlistener(\"ngModelChange\", function CoffeeComponent_section_20_Template_mat_slider_ngModelChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.coffee.tastingRating.aroma = $event);\n    });\n    i0.ɵɵelement(4, \"input\", 5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"label\");\n    i0.ɵɵtext(6, \"Body\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"mat-slider\", 18);\n    i0.ɵɵlistener(\"ngModelChange\", function CoffeeComponent_section_20_Template_mat_slider_ngModelChange_7_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.coffee.tastingRating.body = $event);\n    });\n    i0.ɵɵelement(8, \"input\", 5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"label\");\n    i0.ɵɵtext(10, \"Flavor\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"mat-slider\", 19);\n    i0.ɵɵlistener(\"ngModelChange\", function CoffeeComponent_section_20_Template_mat_slider_ngModelChange_11_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.coffee.tastingRating.flavor = $event);\n    });\n    i0.ɵɵelement(12, \"input\", 5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"label\");\n    i0.ɵɵtext(14, \"Intensity\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"mat-slider\", 20);\n    i0.ɵɵlistener(\"ngModelChange\", function CoffeeComponent_section_20_Template_mat_slider_ngModelChange_15_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.coffee.tastingRating.intensity = $event);\n    });\n    i0.ɵɵelement(16, \"input\", 5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"label\");\n    i0.ɵɵtext(18, \"Sweetness\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"mat-slider\", 21);\n    i0.ɵɵlistener(\"ngModelChange\", function CoffeeComponent_section_20_Template_mat_slider_ngModelChange_19_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r16.coffee.tastingRating.sweetness = $event);\n    });\n    i0.ɵɵelement(20, \"input\", 5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"label\");\n    i0.ɵɵtext(22, \"Aftertaste\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(23, \"mat-slider\", 22);\n    i0.ɵɵlistener(\"ngModelChange\", function CoffeeComponent_section_20_Template_mat_slider_ngModelChange_23_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.coffee.tastingRating.afterTaste = $event);\n    });\n    i0.ɵɵelement(24, \"input\", 5);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngModel\", ctx_r5.coffee.tastingRating.aroma);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r5.coffee.tastingRating.body);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r5.coffee.tastingRating.flavor);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r5.coffee.tastingRating.intensity);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r5.coffee.tastingRating.sweetness);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r5.coffee.tastingRating.afterTaste);\n  }\n}\nfunction CoffeeComponent_mat_option_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 23);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const type_r18 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", type_r18);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(type_r18);\n  }\n}\nexport let CoffeeComponent = /*#__PURE__*/(() => {\n  class CoffeeComponent {\n    constructor(route, geolocation, router, data) {\n      this.route = route;\n      this.geolocation = geolocation;\n      this.router = router;\n      this.data = data;\n      this.types = [\"Espresso\", \"Americano\", \"Latte\", \"Cappucino\", \"Flat white\"];\n      this.newCoffeeGroup = new FormGroup({\n        name: new FormControl('', [Validators.required, Validators.pattern(/^[a-zA-Z_]+( [a-zA-Z_]+)*$/)]),\n        place: new FormControl('', [Validators.required, Validators.pattern(/^[a-zA-Z_]+( [a-zA-Z_]+)*$/)]),\n        address: new FormControl('', [Validators.pattern(/^[a-zA-Z0-9_]+( [a-zA-Z0-9_]+)*$/)]),\n        city: new FormControl('', [Validators.required, Validators.pattern(/^[a-zA-Z_]+( [a-zA-Z_]+)*$/)]),\n        coffeType: new FormControl('', [Validators.required])\n      });\n      this.validateControl = (controlName, errorName) => {\n        const control = this.newCoffeeGroup.get(controlName);\n        return control?.dirty && !control?.touched && control?.hasError(errorName);\n      };\n      this.validateForm = () => {\n        return this.newCoffeeGroup.errors === null;\n      };\n    }\n    tastingRatingChecked(checked) {\n      if (checked) {\n        this.coffee.tastingRating = new TastingRating();\n      }\n    }\n    cancel() {\n      this.router.navigate([\"/\"]);\n    }\n    save() {\n      this.data.save(this.coffee, result => {\n        if (result) {\n          this.router.navigate([\"/\"]);\n        }\n      });\n      if (this.db) {\n        const tx = this.db.transaction(\"coffees\", \"readwrite\");\n        const store = tx.objectStore(\"coffeeList\");\n        const request = store.put(this.coffee);\n      }\n    }\n    ngOnInit() {\n      this.newCoffeeGroup.valueChanges.subscribe(change => {\n        console.log(change);\n        console.log(this.newCoffeeGroup.errors);\n        console.log(this.newCoffeeGroup.status);\n      });\n      this.coffee = new Coffee();\n      this.routingSubscription = this.route.params.subscribe(params => {\n        console.log(params[\"id\"]);\n        if (params[\"id\"]) {\n          this.coffeeId = +params[\"id\"];\n          this.data.getCoffee(params[\"id\"], response => this.coffee = response);\n        }\n      });\n      if (navigator.offline) {\n        const request = indexedDB.open(\"coffees\", 1);\n        request.onerror = error => {\n          reportError(request.error);\n          if (this.db) {\n            this.db.close();\n          }\n        };\n        request.onsuccess = event => {\n          this.db = request.result;\n        };\n        request.onupgradeneeded = function (event) {\n          const db = request.result;\n          if (event.oldVersion < 1) {\n            const coffeeList = db.createObjectStore(\"coffeeList\", {\n              keyPath: \"_id\"\n            });\n            const placeIndex = coffeeList.createIndex(\"by_place\", \"place\");\n          }\n        };\n        if (this.db) {\n          this.db.onversionchange = () => {\n            // First, save any unsaved data:\n            this.save();\n            if (!document.hasFocus()) {\n              location.reload();\n            } else {\n              alert(\"Please reload this page for the latest version.\");\n            }\n          };\n        }\n        ;\n      }\n      this.geolocation.requestGeoLocation(location => {\n        if (location && this.coffee.location) {\n          this.coffee.location.latitude = location.latitude;\n          this.coffee.location.longitude = location.longitude;\n        }\n      });\n    }\n    ngOnDestroy() {\n      this.routingSubscription.unsubscribe();\n    }\n  }\n  CoffeeComponent.ɵfac = function CoffeeComponent_Factory(t) {\n    return new (t || CoffeeComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.GeoLocationService), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i3.DataService));\n  };\n  CoffeeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CoffeeComponent,\n    selectors: [[\"app-coffee\"]],\n    decls: 33,\n    vars: 13,\n    consts: [[3, \"formGroup\"], [\"matInput\", \"\", \"placeholder\", \"Coffee name\", \"name\", \"coffee\", \"formControlName\", \"name\", 3, \"ngModel\", \"ngModelChange\"], [4, \"ngIf\"], [\"matInput\", \"\", \"placeholder\", \"Place name\", \"name\", \"place\", \"formControlName\", \"place\", 3, \"ngModel\", \"ngModelChange\"], [\"min\", \"0\", \"max\", \"10\", \"showTickMarks\", \"\", \"discrete\", \"\", \"name\", \"coffee.rating\", \"step\", \"1\", 3, \"ngModel\", \"ngModelChange\"], [\"matSliderThumb\", \"\"], [3, \"change\"], [\"tastingSelector\", \"\"], [\"id\", \"tasting-rating\", 4, \"ngIf\"], [\"placeholder\", \"Coffee type\", \"name\", \"coffe type\", \"formControlName\", \"coffeeType\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"matInput\", \"\", \"placeholder\", \"Notes\", \"name\", \"notes\", 3, \"ngModel\", \"ngModelChange\"], [\"mat-raised-button\", \"\", 3, \"click\"], [\"mat-raised-button\", \"\", \"color\", \"accent\", 3, \"disabled\", \"click\"], [\"matInput\", \"\", \"placeholder\", \"Address\", \"name\", \"address\", \"formControlName\", \"location\", \"pattern\", \"/\\\\w+(\\\\s\\\\w+){2,}/\", 3, \"ngModel\", \"ngModelChange\"], [\"matInput\", \"\", \"placeholder\", \"City\", \"name\", \"city\", \"formControlName\", \"city\", \"pattern\", \"/[^a-zA-Z\\\\s]/\", 3, \"ngModel\", \"ngModelChange\"], [\"id\", \"tasting-rating\"], [\"min\", \"0\", \"max\", \"10\", \"showTickMarks\", \"\", \"discrete\", \"\", \"step\", \"1\", \"name\", \"aroma\", 3, \"ngModel\", \"ngModelChange\"], [\"min\", \"0\", \"max\", \"10\", \"showTickMarks\", \"\", \"discrete\", \"\", \"step\", \"1\", \"name\", \"body\", 3, \"ngModel\", \"ngModelChange\"], [\"min\", \"0\", \"max\", \"10\", \"showTickMarks\", \"\", \"discrete\", \"\", \"step\", \"1\", \"name\", \"flavor\", 3, \"ngModel\", \"ngModelChange\"], [\"min\", \"0\", \"max\", \"10\", \"showTickMarks\", \"\", \"discrete\", \"\", \"step\", \"1\", \"name\", \"intensity\", 3, \"ngModel\", \"ngModelChange\"], [\"min\", \"0\", \"max\", \"10\", \"showTickMarks\", \"\", \"discrete\", \"\", \"step\", \"1\", \"name\", \"sweetness\", 3, \"ngModel\", \"ngModelChange\"], [\"min\", \"0\", \"max\", \"10\", \"showTickMarks\", \"\", \"discrete\", \"\", \"step\", \"1\", \"name\", \"afterTaste\", 3, \"ngModel\", \"ngModelChange\"], [3, \"value\"]],\n    template: function CoffeeComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r19 = i0.ɵɵgetCurrentView();\n        i0.ɵɵelementStart(0, \"form\", 0)(1, \"mat-card\")(2, \"mat-card-title\");\n        i0.ɵɵtext(3, \"Basic Information\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"mat-form-field\")(5, \"input\", 1);\n        i0.ɵɵlistener(\"ngModelChange\", function CoffeeComponent_Template_input_ngModelChange_5_listener($event) {\n          return ctx.coffee.name = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(6, CoffeeComponent_mat_error_6_Template, 2, 0, \"mat-error\", 2);\n        i0.ɵɵtemplate(7, CoffeeComponent_mat_error_7_Template, 2, 0, \"mat-error\", 2);\n        i0.ɵɵelementStart(8, \"mat-form-field\")(9, \"input\", 3);\n        i0.ɵɵlistener(\"ngModelChange\", function CoffeeComponent_Template_input_ngModelChange_9_listener($event) {\n          return ctx.coffee.place = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(10, CoffeeComponent_mat_form_field_10_Template, 2, 1, \"mat-form-field\", 2);\n        i0.ɵɵtemplate(11, CoffeeComponent_mat_form_field_11_Template, 2, 1, \"mat-form-field\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"mat-card\")(13, \"mat-card-subtitle\");\n        i0.ɵɵtext(14, \"Overall Rating\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"mat-slider\", 4);\n        i0.ɵɵlistener(\"ngModelChange\", function CoffeeComponent_Template_mat_slider_ngModelChange_15_listener($event) {\n          return ctx.coffee.rating = $event;\n        });\n        i0.ɵɵelement(16, \"input\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(17, \"mat-slide-toggle\", 6, 7);\n        i0.ɵɵlistener(\"change\", function CoffeeComponent_Template_mat_slide_toggle_change_17_listener() {\n          i0.ɵɵrestoreView(_r19);\n          const _r4 = i0.ɵɵreference(18);\n          return i0.ɵɵresetView(ctx.tastingRatingChecked(_r4.checked));\n        });\n        i0.ɵɵtext(19, \"Tasting Rating\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(20, CoffeeComponent_section_20_Template, 25, 6, \"section\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"mat-card\")(22, \"mat-card-subtitle\");\n        i0.ɵɵtext(23, \"Coffee type\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"mat-select\", 9);\n        i0.ɵɵlistener(\"ngModelChange\", function CoffeeComponent_Template_mat_select_ngModelChange_24_listener($event) {\n          return ctx.coffee.type = $event;\n        });\n        i0.ɵɵtemplate(25, CoffeeComponent_mat_option_25_Template, 2, 2, \"mat-option\", 10);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(26, \"mat-card\")(27, \"textarea\", 11);\n        i0.ɵɵlistener(\"ngModelChange\", function CoffeeComponent_Template_textarea_ngModelChange_27_listener($event) {\n          return ctx.coffee.notes = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(28, \"mat-card\")(29, \"button\", 12);\n        i0.ɵɵlistener(\"click\", function CoffeeComponent_Template_button_click_29_listener() {\n          return ctx.cancel();\n        });\n        i0.ɵɵtext(30, \"Cancel\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(31, \"button\", 13);\n        i0.ɵɵlistener(\"click\", function CoffeeComponent_Template_button_click_31_listener() {\n          return ctx.save();\n        });\n        i0.ɵɵtext(32, \"Save\");\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        const _r4 = i0.ɵɵreference(18);\n        i0.ɵɵproperty(\"formGroup\", ctx.newCoffeeGroup);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.coffee.name);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.validateControl(\"name\", \"require\"));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.validateControl(\"name\", \"pattern\"));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngModel\", ctx.coffee.place);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.coffee.location);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.coffee.location);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.coffee.rating);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", _r4.checked);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.coffee.type);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.types);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngModel\", ctx.coffee.notes);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"disabled\", !ctx.validateForm());\n      }\n    },\n    dependencies: [i4.ɵNgNoValidate, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.PatternValidator, i4.FormGroupDirective, i4.FormControlName, i4.NgModel, i5.NgForOf, i5.NgIf, i6.MatButton, i7.MatInput, i8.MatFormField, i8.MatError, i9.MatSelect, i10.MatOption, i11.MatSlider, i11.MatSliderThumb, i12.MatSlideToggle, i13.MatCard, i13.MatCardSubtitle, i13.MatCardTitle],\n    styles: [\"mat-card[_ngcontent-%COMP%]{margin:20px}input[_ngcontent-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%], mat-select[_ngcontent-%COMP%]{width:100%}mat-card-title[_ngcontent-%COMP%]{font-size:larger}mat-slider[_ngcontent-%COMP%]{width:90%}\"]\n  });\n  return CoffeeComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}